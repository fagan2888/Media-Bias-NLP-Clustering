The Obama administration vehemently denied Wednesday that it lied to a federal judge about President Obama’s deportation amnesty, but the court is moving to punish him anyway, saying his lawyers were either ignorant or intended to mislead the court when they insisted the amnesty policy was on hold.

In fact, the administration had already processed more than 100,000 cases of so-called Dreamers under the three-year provisions Mr. Obama announced in November — something the president’s lawyers belatedly admitted to Judge Andrew S. Hanen.

“Whether by ignorance, omission, purposeful misdirection, or because they were misled by their clients, the attorneys for the government misrepresented the facts,” the judge said, adding that he was stunned the government waited months before coming forward.

SEE ALSO: Judge accuses Obama lawyers of misleading him, refuses to restart amnesty

Late Tuesday, Judge Hanen issued an order rebuking the administration and granting Texas, which is suing to halt the amnesty, limited discovery in the case. For now, that means the government must turn over documents showing its thought process on how it was planning to carry out the amnesty.

Judge Hanen also shot down the Justice Department’s request to lift an injunction and restart the amnesty immediately, either nationwide or at least in some states where governors have asked for it. The judge said he’s more convinced than ever that Mr. Obama broke federal law when he announced the amnesty last November.

In particular, Judge Hanen said the president’s declaration in a televised town hall in February that agents who ignored his policies would face “consequences” shows Mr. Obama intended to rewrite the law, not to carry it out.

SEE ALSO: Court’s ‘Dreamer’ ruling could undercut efforts to block amnesty

“In summary, the chief executive has ordered that the laws requiring removal of illegal immigrants that conflict with the 2014 DHS directive are not to be enforced, and that anyone who attempts to do so will be punished,” Judge Hanen wrote.

The White House defended Mr. Obama’s policies as “common sense” — but spokesman Josh Earnest also stumbled, calling them “legislative action” before correcting himself. Under the Constitution, only Congress can write legislation, while the president is charged with carrying out the laws, not writing them.

“We continue to have strong confidence in the legal arguments that we’re making,” Mr. Earnest said, adding that they already had an appeal pending of Judge Hanen’s earlier injunction, and will pursue that review.

Meanwhile, the Justice Department bristled at the judge’s accusation that government lawyers misled him.

“We emphatically disagree with the district court’s order regarding the government’s statements,” department spokeswoman Emily Pierce said.

Judge Hanen’s rulings capped a busy day that saw both sides of the immigration debate notch victories and defeats.

Earlier Tuesday, the Fifth Circuit Court of Appeals tossed out a challenge to Mr. Obama’s 2012 amnesty for Dreamers, finding that neither Mississippi nor immigration enforcement agents, both of whom had sued to stop that amnesty, had standing in court.

Immigrant rights activists said that bodes well for their cause because that same appeals court is hearing the appeal of Judge Hanen’s injunction.

But some legal analysts said Texas and its fellow states have argued their case differently, including presenting specific evidence of economic harm from Mr. Obama’s latest amnesty, which could earn them standing where Mississippi failed.

For now, the 2012 amnesty for Dreamers remains operational, granting more than 600,000 young adult illegal immigrants tentative legal status and work permits for two years. But Judge Hanen’s injunction has halted the 2014 amnesty, leaving millions of other Dreamers and illegal immigrant parents who stood to benefit still in limbo — though Mr. Obama has said he won’t deport them anyway.