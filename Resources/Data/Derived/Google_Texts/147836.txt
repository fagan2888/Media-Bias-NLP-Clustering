After two years of alternating battle and persuasion, Bill de Blasio has finally managed to get his dreams of a vast affordable-housing program enshrined in city law. Getting to this point has meant promising billions in public funds, and also steamrolling skeptics, experts, preservationists, community boards, political opponents, unions, and activists. (It also required the forcible removal from City Council chambers of protesters who had superglued themselves into a human chain to protest the vote.) The zoning overhaul — the most sweeping since 1961 — represents a major triumph for de Blasio’s development generals, planning commissioner Carl Weisbrod and Deputy Mayor Alicia Glen, and proves the administration’s ability to translate progressive desires into policy, and policy into reality. The program’s passage will also un-stopper Champagne bottles in a lot of developers’ offices, since they can now forge ahead on a sea of city subsidies, calmed by more generous rules. The point, after all, is to help New York build more so that more New Yorkers can have an affordable place to live.

The de Blazoning amounts to the mayor’s version of Obamacare, an imperfect but monumental legacy program on which he staked his political credibility. As with health care, the rezoning program has been crafted to nudge the private market, not replace it; to protect many but not all; to withstand economic tumult; to outlive the current administration by a lifetime at least; and to dole out its effects over decades. It marshals thousands of arcane details into a new bureaucratic landscape that will give many citizens room to breathe. As with health care, it has downsides — especially for those who like the city just the way it is, or, rather, the way it was.

Every big change in the rules affects the texture of the city. The original 1916 zoning code produced the Art Deco era of setback skyscrapers. The 1961 update gave us flat-front towers and low-ceilinged apartments. As I have attempted to explain before, the new plan consists of three coordinated campaigns: 1) gradually rezoning large swaths of the city, 2) decreeing that when areas do get rezoned, all new buildings must include a sizable chunk of affordable housing, and 3) updating the citywide rules to improve the kinds of buildings that go up — higher ceilings, more storefronts, bay windows, texture, and stoops. But the effects will vary drastically by zip code. All three parts, twined together, will quickly reshape East New York, a transformation primed by billions of city subsidies. The heart of the Upper East Side, however, will probably continue its untroubled existence for decades without noticing a quiver of change. Cumulatively, the new rules will erect a defensive line against the blitzkrieg of rising real-estate prices, and they will lock those protections in, making it more difficult to evict the vulnerable. They will also make some neighborhoods denser, taller, and more likely to evolve.

The de Blasio administration claims that citizens will now be able to reap the benefits of transformations that are taking place anyway. Critics believe that the new rules will cause change they can’t control. Both are correct, because the city doesn’t actually construct housing; it merely encourages private builders with a combination of prods and rewards. That fact leads to the affordability conundrum: Developers build affordable housing where they can make money doing so, which is to say wherever prices are high enough to promise a return. And the higher the prices, the greater the need for affordable housing. De Blasio hasn’t solved that paradox, but he may have found a way to reduce its toxicity.