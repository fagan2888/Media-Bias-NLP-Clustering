(Reuters) - BNY Mellon Corp was scrambling to fix a computer glitch on Wednesday that has delayed how billions of dollars of assets are valued, throwing the U.S. funds industry into disarray and damaging the reputation of the world's largest custody bank.

BNY Mellon said an accounting system it relies on to calculate the prices of clients' mutual funds and exchange traded funds (ETFs) broke down over the weekend just as investors headed into a global market meltdown sparked by fears over the Chinese economy.

The system, run by financial software provider SunGard, resumed with limited capacity on Tuesday but was still not fully operational on Wednesday, leaving BNY Mellon with a backlog of funds to price.

SunGard, which is being bought by rival software provider Fidelity National Information Services, did not return messages seeking comment.

BNY Mellon raised the alarm with regulators and held emergency calls with customers to try and resolve the problem.

"No one here can understand why it's not up and running yet," said one executive at a firm that was affected.

The glitch occurred on a SunGard system called InvestOne, which is used by financial institutions managing more than $28 trillion in assets.

BNY Mellon said it outsources some of its net asset value (NAV) calculations to SunGard.

The timing of the pricing glitch happened as China's stock market meltdown reverberated around the globe, spooking investors while casting doubt on whether the U.S. Federal Reserve would raise interest rates this year.

"No one needs any more uncertainly in the markets or in investors' investment accounts,‚Äù said Dan Sondhelm, senior vice president at SunStar Strategic, a financial services consulting company in Alexandria, Virginia.

Several dozen funds run by Federated Investors Inc alone were affected by the pricing glitch, including the $1.2 billion Federated Muni and Stock Advantage Fund, Federated said.

Invesco PowerShares Capital Management had 11 ETFs affected by the glitch, a spokeswoman said.

In a letter to clients, BNY Mellon said, "We recognize the trust that you have placed in us, and sincerely regret the disruption this has caused you and your organization."

New York-based BNY Mellon has been under fire from some hedge fund investors for having too many employees and not reining in expenses. The bank has nearly $30 trillion in assets under custody and administration. Smooth fund accounting is something its clients rely on.

Its archrival, State Street Corp is considered the No. 1 provider of mutual fund accounting services.

BNY Mellon spokesman Kevin Heine said he did not know how many funds had been affected.

In addition to Federated Investors, Guggenheim Investments and First Trust Advisors both had ETFs affected by the glitch, the firms said.

"The SunGard system became available with limited capacity late yesterday," Heine said on Wednesday. "Our teams have been working together to clear the backlog and we are working with SunGard to resume normal processing as soon as possible."

BNY Mellon said it was able to construct Monday net asset values (NAVs) for all affected funds. But there remains a backlog of Tuesday NAVs that still need to be generated.

First Trust, which manages several exchange-traded funds, said on Wednesday in a statement that the net asset value of some of its funds contained errors greater than 1 percent.

"The errors resulted from a technical malfunction at our third party administrator, the Bank of New York Mellon," First Trust said.

(Reporting by Tim McLaughlin in Boston and Jessica Toonkel in New York; Additional reporting by Ross Kerber in Boston.; Editing by Andrew Hay, Carmel Crimmins and Lisa Shumaker)