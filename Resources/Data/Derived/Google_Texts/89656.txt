Riding a wave of anti-snooping sentiment, the House voted Thursday to halt the government’s probing of Americans’ emails and other data scooped up as part of its foreign intelligence dragnet collection.

The vote came just a week after Congress voted to curtail the Patriot Act by ending the government’s bulk collection of documents and records that businesses keep on their customers’ activities. That ended the National Security Agency’s phone records program, but privacy advocates said it didn’t touch the more intrusive programs that target foreigners’ emails — and end up snagging Americans’ communications in the process.

Thursday’s 255-174 vote, which came as part of the debate on the annual defense spending bill, would fix that. It also would prohibit the government from insisting software companies build backdoor access into encryption algorithms that the FBI and intelligence community could use to gain access to information Americans want to keep private.

“This amendment is the most meaningful step Congress can take to end warrantless bulk collection of U.S. persons’ communications and data,” said Rep. Zoe Lofgren, a California Democrat who joined Rep. Thomas Massie, Kentucky Republican, in the push for the new protections.

They led a strong bipartisan coalition, with 109 Republicans joining 146 Democrats in voting for the changes to Section 702 of the Foreign Intelligence Surveillance Act, which granted snooping powers even before the Patriot Act was passed in the wake of the Sept. 11, 2001, terrorist attacks.

The ban still needs approval from a Senate likely to be more skeptical of turning off an important snooping tool, and senators have run into gridlock on a number of security-related issues in recent weeks.

On Thursday, Democrats led a filibuster to block a cybersecurity bill, just two weeks after the IRS admitted it had been breached by a hack that stole personal information on more than 100,000 taxpayers and a week after the federal Office of Personnel Management said hackers stole information about millions of federal employees from OPM’s databases.

Democratic leaders complained that the bill was being jammed together with the annual defense policy bill — a companion to the annual spending bill — and said their filibuster was an effort to separate the debates and allow for amendments.

Sen. John Cornyn, Texas Republican, called the filibuster “just flat irresponsible” given all the cyberattacks in the news.

“These are not threats we can afford to ignore,” he said.

But Republicans have themselves to blame too. They earned the support of a half-dozen Democrats and one independent, but saw three Republicans defect to vote against the bill over privacy concerns, and saw two Republicans — presidential candidates Sens. Ted Cruz and Marco Rubio — miss the vote entirely. If the GOP had been present and unified, they could have overcome the filibuster.

Privacy and security are increasingly clashing in debates on Capitol Hill, and the FISA vote in the House was just the latest manifestation.

Intelligence community backers said Congress should leave the NSA’s snooping alone, saying the growing threat from terrorists must be countered with broad gathering powers.

“This amendment would impose greater restrictions on the intelligence community’s ability to protect national security and create a greater impediment to our government’s ability to locate threat information already in our government’s possession,” said Rep. Rodney P. Frelinghuysen, New Jersey Republican.

While the outlines of data gathered under Section 702 remain shrouded, some details have emerged. Under the program, the government is allowed to scoop up communications of foreigners outside the U.S. It’s not supposed to target Americans, or even foreigners in the U.S., but their data can be kept and searched if it’s swept up in the dragnet for foreign communications.

Director of National Intelligence James R. Clapper has affirmed that the databases have been queried specifically for information on U.S. persons. He said they felt comfortable going ahead with those searches because Congress had refused to set limits on the data’s use.

The proposal from Mr. Massie and Ms. Lofgren would establish those limits.

Section 702 is due to expire at the end of 2017, and Mr. Frelinghuysen said the fight should be left for another day, pleading with colleagues to let the committees that oversee the intelligence community work out any changes.

“This is an issue critical to our national security, and it is complicated,” he said, comparing the snooping on U.S. persons’ communications to state and local police conducting a wiretap on a drug dealer, but using what they hear to investigate other people’s crimes too.

The defense spending bill saw several other fights erupt in addition to the snooping. The House rejected two efforts to reel in the Pentagon’s program to ship surplus weapons and equipment to state and local police.

Rep. Henry C. “Hank” Johnson, Georgia Democrat, had tried to limit transfer of “flash-bang” grenades and heavily armored Mine-Resistant Ambush Protected (MRAP) vehicles, which some critics have said has led to heightened tensions between police and protesters in recent years.

The House also shot down several efforts to put a deadline on how long President Obama would have to fight terrorists under the 2001 and 2002 authorizations for use of military force against al Qaeda and in Iraq.