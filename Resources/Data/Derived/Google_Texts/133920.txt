Medicare’s attempts to hold hospitals accountable for poor quality treatment is inadvertently penalizing hospitals that take care of sicker, poorer patients, according to a new study published in JAMA Internal Medicine.

A provision in the Affordable Care Act requires Medicare to reduce payments to hospitals that have high readmission rates. The goal was to improve patient care and cut the costs of avoidable hospitalizations. Instead, the new study finds that the Obamacare change unfairly affects hospitals based on the patients they treat.

Related: Millions Facing a Hefty Increase in Medicare Premiums in 2016

The current Medicare readmissions rate is high, with close to one in five elderly patients returning to the hospital within 30 days of leaving, and it’s also costly —readmissions cost Medicare $26 billion annually, $17 billion of which is spent on return trips that might not have been necessary if proper care was received in the first place.

The calculations that Medicare uses in determining its readmission penalties only adjust for certain demographic information, such as age, sex and the sickness of patients, but leave out socioeconomic and medical aspects of a hospital’s patient population, the authors of the new study write. Hospitals with the highest readmissions rates had patients who suffered from more chronic conditions, were poorer and had less education.

The study, conducted by researchers at Harvard Medical School, the Brigham and Women’s Hospital in Boston and Massachusetts General Hospital, found that about half of the difference in readmission rates among hospitals is due to variables linked to the patient population being treated, including education and income levels. “Hospitals with high readmission rates may be penalized to a large extent based on the patients they serve,” the authors conclude.

Related: White House Takes Aim at Billions in Medicare and Medicaid Fraud

As a result, the penalties that Medicare imposes could be depriving hospitals treating a disadvantaged population of money they need to treat those patients and their complex health issues.

A spokesman for the Centers for Medicare and Medicaid Services told The Washington Post that for the fiscal year beginning on Oct. 1, more than 2,600 hospitals will lose $420 million because of the penalty.

The Centers for Medicare and Medicaid Services says it is looking at the readmissions penalty program and any unintended consequences it might be having.