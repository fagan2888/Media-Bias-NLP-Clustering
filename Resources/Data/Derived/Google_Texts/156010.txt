A large crowd greets Virginia Tech head coach Frank Beamer as he makes his last walk to the stadium prior to the start of an NCAA college football game between North Carolina and Virginia Tech in Blacksburg, Va., Saturday, Nov. 21, 2015. It is the last home game for Beamer who has announced his retirement. (AP Photo/Steve Helber) The Associated Press

By HANK KURZ Jr., AP Sports Writer

BLACKSBURG, Va. (AP) â€” North Carolina defensive end Mikey Bart started celebrating too soon. Marquise Williams made sure his 12th-ranked Tar Heels were able to celebrate at all.

Williams hit Quinshad Davis with a 5-yard pass in overtime and the Tar Heels spoiled coach Frank Beamer's final home game at Virginia Tech with a 30-27 victory on Saturday. And they did it after blowing a 14-point lead in the last three minutes of regulation.

"We were definitely shocked," Bart said after registering 2 1/2 of the Tar Heels' five sacks. "Around the two-minute mark, I was like, 'Oh yeah. We got the ACC.' We were already talking about rings and stuff."

The Hokies nearly foiled their plan, scoring a touchdown with 2:54 to play and another with 1:07 left to pull even, but the Tar Heels regrouped in the extra period. They allowed just two yards in three plays and forced Virginia Tech to kick a 41-yard field goal.

Williams and his receivers did the rest. He hit Ryan Switzer for 18 yards on the first play and Davis for the winning touchdown.

"Emotional. Bittersweet," Williams said after throwing for 205 yards, running for 74 and overcoming two lost fumbles in the final five minutes. "That was a hard game. Everybody panicking. Heart attacks going left and right. We just had to find a way."

The Tar Heels (10-1, 7-0 ACC, No. 17 CFP) won their 10th in a row and clinched the Coastal Division title for the first time.

They will face No. 1 Clemson in the league title game on Dec. 5 in Charlotte, North Carolina.

Beamer, who thanked the fans after the game and was carried off the field by his team, wiped tears away while walking with the team to the locker room before the game, but said he succeeded in not getting too caught up in the emotion as the game was in progress.

And he's not ready to travel too far down memory lane with at least one game, and possibly two, remaining.

"I don't think so much about the 'last' time," he said. "I think about the 29 years being so blessed."

Virginia Tech (5-6, 3-4) almost made it so again, using Williams' two lost fumbles to make a startling comeback.

Vinny Mihota caused the first, recovered by Woody Baron, and Brewer drove his team 63 yards in eight plays, hitting Sam Rogers for 25 yards, Ford for 26 and Bucky Hodges from 8 yards out to make it 24-17.

Three plays later, Luther Maddy forced Williams to cough it up again, and Anthony Shegog recovered. The Hokies drove 48 yards in five plays, starting with Brewer's 36-yard connection with Ford. On fourth-and-2 at the 4, Brewer hit a sliding Ford for the tying touchdown.

"We felt like it was our turn to make some plays," Brewer said.

The Hokies tried to give Beamer a win in the final home game of his 29-year career. They shut down the ACC's most potent offense for three quarters, but hurt themselves with late turnovers. Elijah Hood, who ran for 115 yards, converted two of them into touchdowns.

Virginia Tech now needs to win at Virginia next Saturday to give Beamer a 23rd consecutive bowl appearance.

For a time, it looked like Bud Foster's defense would give the Hokies a chance. The Tar Heels came in having scored 125 points in their last two games. They were second in the league with an average of 495 yards of offense, but managed just 193 in three quarters.

After falling behind 10-3, missing a field goal and squandering a good scoring opportunity after forcing the Tar Heels' first turnover in four games, the Hokies put together their best drive of the day.

Brewer hit Cam Phillips for 10 yards on a third-and-8 from midfield, Rogers had an 18-yard run and Brewer carried it the last three yards on a third-and-goal draw play to pull Virginia Tech even.

___

Follow Hank on Twitter: www.twitter.com/hankkurzjr

___

AP college football website: www.collegefootball.ap.org