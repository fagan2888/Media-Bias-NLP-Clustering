Former CIA Director David Petraeus returned to Capitol Hill Tuesday for the first time since his 2012 resignation to detail his strategy for the United States to escalate military involvement in Iraq and Syria.

In testimony before the Senate Armed Services Committee, Petraeus advised the U.S. to form enclaves in Syria protected by coalition airpower to strengthen support for moderate Sunni rebels, train additional forces, and provide haven for displaced Syrians.

He also urged the U.S. to take a hardline position against President Bashar al-Assad’s indiscriminate barrel-bomb attacks that the Syrian Air Force continues to deploy across civilian areas.

“We have that capability,” Petraeus said. “It would demonstrate that the United States is willing to stand against Assad and it would show the Syrian people that we can do what the Islamic State cannot—provide them with a measure of protection.”

Petraeus, a retired four-star army general who led the 2007 surge in Iraq, said while the U.S. has made significant advances in the nation against the Islamic State, “We are not where we should be at this point.”

President Barack Obama’s fight against ISIS has hit numerous barriers over the past year since the war began in August 2014 as the administration’s limited military campaign struggles to gain traction.

Retired Gen. John Allen, who Obama appointed to craft the military effort against ISIS, is expected to step down from his position this November amid the U.S.’s faltering efforts, Bloomberg reported Tuesday.

The White House announcement comes just a month after incoming Marine Corps Commandant Lt. Gen. Robert Neller, testified the war is at a “stalemate.”

To turn this around, Petraeus urged Obama to escalate the military effort in Iraq through strengthened support for the Iraqi security forces, Sunni tribal forces and the Kurdish peshmerga, all of which are fighting against ISIS.

The administration should also embed U.S. advisers with Iraqi forces at the brigade level, he said, and “explore use of joint tactical air controllers with select Iraqi units to coordinate coalition airstrikes for those units.”

But he warned that the military should “exercise restraint” to ensure it does not “take over Iraqi units,” advising against American personnel being embedded at the Iraqi battalion level.

“I do not make recommendations for any kind of military action lightly,” he said. “But inaction can also carry profound risks and costs for our national security.”