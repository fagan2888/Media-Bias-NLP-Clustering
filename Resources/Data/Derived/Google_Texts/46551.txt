Dependent almost entirely on foreign aid, Afghan security forces are struggling to secure the country amid a rising insurgency.

As the NATO-led coalition's military presence dwindled last year, Afghan leaders reached out to Moscow, which fought a war of its own in Afghanistan during the 1980s, for more Russian-made weapons, including small arms, artillery and attack helicopters.

"This donation represents a deep friendship between two nations," Afghan national security adviser Hanif Atmar said at an event marking delivery of the arms shipment. "This important donation is from an important friend of Afghanistan in a crucial time for Afghanistan and the region."

The guns and ammunition were provided under an existing security agreement between the two countries, he added.

Russia's ambassador, Alexander Mantytskiy, told the gathered military and security officers that his country is willing to work with Afghanistan to combat problems like terrorism and drugs.

Wednesday's delivery comes as Russian officials say they have become impatient with the failures of Washington's policies in Afghanistan.

While never a member of the coalition, Russia cooperated with the United States for years by allowing military supplies to travel through its territory, and in other areas such as counter-narcotics and weapons supplies.

That cooperation has disappeared amid political rifts over the wars in Ukraine and Syria. Top Russian officials, openly critical of the lingering American presence, have said they are seeking deeper ties to the Kabul government, as well the Taliban.

(Reporting by Mirwais Harooni and Josh Smith; Editing by Richard Borsuk)