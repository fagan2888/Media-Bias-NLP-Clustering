An elderly homeless man is admitted to the emergency room complaining of a fever and cough. Doctors take an X-ray and diagnose him with pneumonia. They keep him in the hospital for three days while he takes antibiotics and recovers. Then they discharge him, telling him to continue taking the antibiotics for another week. He takes only half his pills and the disease returns, so he checks back into the hospital. Who's to blame?

According to the federal government, the hospital is. Under the Affordable Care Act, hospitals are fined up to 3 percent of their Medicare payments if too many Medicare patients return to the hospital within 30 days of discharge. By giving hospitals a financial incentive to reduce readmissions, the idea is to encourage better quality care.

It's turned out to be a rather large incentive. In 2015, 2,592 hospitals around the country -- more than half of those in operation -- were hit with readmissions penalties, which totaled $420 million.

Yet a study published this week in JAMA Internal Medicine suggests that many readmissions are unavoidable, especially those involving patients like our hypothetical homeless man with pneumonia. The authors of the paper, who are all affiliated with Harvard Medical School, examined 29 patient characteristics -- including race, education, disability, alcohol intake and prescription drug benefits -- to see whether they had an impact on readmissions.

And -- surprise, surprise -- they did. The study found that these 29 factors account for nearly half the difference between the readmissions rates at the best- and the worst-performing hospitals.

Medicare officials already make some effort to account for the differences in hospitals' patient populations. In computing the expected readmissions rate for any given hospital, they factor in a handful of patient characteristics, including age, sex and conditions being treated.

But a number of groups, including the American Hospital Association, have argued that Medicare doesn't sufficiently account for the differences among hospitals. Specifically, they say that the current system penalizes hospitals that admit a larger-than-average share of the poor and especially ill individuals who are the most likely to return to a hospital no matter how effective their care is.

The new study supports that idea. Once researchers factored in all the other measures, many of which were associated with socioeconomic status, the readmissions gap between the top and bottom quartiles of hospitals shrunk from 4.4 percentage points to 2.3 percentage points.

"By taking account of that disparity between the patient populations between the best- and worst-performing hospitals, we really narrow that range, and so the worst-performing hospitals don't look nearly as bad," said the study's lead author, Harvard gerontologist Michael Barnett.

"And maybe the best-performing hospitals don't look as good, because they're taking care of patients that are much less likely to have been readmitted in the first place," he added.

Prior research has suggested that teaching hospitals, such as those affiliated with Harvard Medical School, are among the institutions hit hardest by readmissions penalties because they tend to serve a disproportionately large share of at-risk patients.

Medicare's failure to account for hospital differences doesn't only hurt the facilities' bottom line, Barnett said. It could also hurt patients. That's because the incentive program discourages hospitals from admitting patients who are likely to be readmitted. And it takes money away from hospitals that do serve such patients, making them less able to treat future patients effectively.

Barnett admitted that it would be difficult for Medicare to take all 29 of the factors his team analyzed into account when assessing penalties. But he noted that the health records that Medicare officials use to compute the penalties already include a number of those factors, and that if the program accounted for just those additional factors, the difference between the best- and worst-performing hospitals would shrink by 25 to 30 percent. Bills before the House and Senate would require that Medicare do so.

An even better approach, to Barnett's mind, would be to shift the readmission rate calculation toward one focused on improvement. That way, hospitals would be judged by how much they reduced readmissions from year to year -- which is ultimately the point.