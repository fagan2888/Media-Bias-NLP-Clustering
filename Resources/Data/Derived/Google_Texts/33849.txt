BERLIN (AP) - Wayward insoles cost Eliud Kipchoge a chance to break a world record.

Despite problems with his shoes from the first kilometer, Kipchoge won the Berlin Marathon on Sunday in a personal best time of 2 hours, 4 minutes.

The Kenyan’s insoles were noticeably slipping out of his runners around the 20K mark, flapping behind him as he maintained a leading pace with training partner Emmanuel Mutai and 2012 race winner Geoffrey Mutai.

Geoffrey Mutai, no relation to Emmanuel, fell behind around the 30K mark and Kipchoge made his move two kilometers further on.

“I didn’t have time to pull the soles out,” said Kipchoge, who had been targeting compatriot Dennis Kimetto’s world record of 2:02:57 from Berlin last year. “The world record was my target. I didn’t manage it but I’ll be back next year.”

Running his sixth Berlin marathon, Kipchoge finished comfortably ahead of compatriot Eliud Kiptanui in second on 2:05:22 and Feyisa Lilesa of Ethiopia third in 2:06:57. All times were official.

“From the first kilometer I had problems with my shoes,” Kipchoge said. “Nevertheless, I am very happy about my victory. I love the Berlin course and the people. I’m glad I won and in a personal best. I would very much love to come back and run an even faster time.”

Emmanuel Mutai was fourth and Geoffrey Mutai fifth, ahead of Canada’s Reid Coolseat, who ran 2:10:28.

Kipchoge shaved five seconds off his previous personal best time and 42 seconds off the previous fastest mark of the year that he set at the London Marathon on April 26.

Despite acknowledging that he “could have run faster,” Kipchoge laid no fault with his sponsor for his footwear issues.

“I tested the shoe, I tested many pairs of Nike. I think this shoe is the best shoe ever. The shoe is good,” the 30-year-old said. “The sole was not glued. I used the same pair in Kenya and it was good.”

Kiptanui was happy with his second-place finish.

“I think I had no chance to beat Eliud,” said Kiptanui, who knocked 17 seconds off his personal best set in Prague in 2010.

Kipchoge clocked 2:04:05 in 2013 only to be beaten by compatriot Wilson Kipsang, who set a then-record of 2:03:23.

Gladys Cherono of Kenya beat the 2:20 mark to win the women’s race in 2:19.25 ahead of Ethiopian trio Aberu Kebede, Meseret Hailu and Tadelech Bekele.

It was Cherono’s first win in only her second marathon. The 32-year-old half marathon world champion ran 2:20:03 for second place in her debut in Dubai last January.

Conditions were ideal on a cool, crisp autumn morning in Berlin. More than 41,000 runners from 131 countries were registered to run.