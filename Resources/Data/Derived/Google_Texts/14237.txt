SAN FRANCISCO (AP) - The bullet that killed a young San Francisco woman may have ricocheted before striking her in the back while she was sightseeing with her father along the city’s popular waterfront, a ballistic expert testified Wednesday.

The testimony could prove important after Juan Francisco Lopez-Sanchez admitted to firing the fatal shot, but said it was an accident.

The July 1 shooting sparked a national debate over San Francisco’s policy of ignoring federal requests to detain inmates wanted for deportation.

Lopez-Sanchez, 45, had been deported five times previously. Immigration officials wanted to remove him from the country a sixth time when he was released from San Francisco jail in April despite a federal detainer request.

San Francisco police ballistics expert Andy Smith testified Wednesday during a preliminary hearing to determine if there’s enough evidence to try Lopez-Sanchez for murder.

Smith said the hollow-point bullet that killed Kate Steinle, 32, was flattened on one side.

“The bullet struck a very hard surface … concrete, steel, very hard metal,” Smith testified.

Lopez-Sanchez said he found the Sig Sauer .40-caliber pistol wrapped in a t-shirt under a bench on San Francisco’s pier 14. The gun belonged to a Bureau of Land Management ranger, who reported that his service weapon was stolen from his car in downtown San Francisco in June.

Divers plucked the gun from the San Francisco Bay next to the pier the day after the shooting.

Smith testified that the gun was in good, working condition and that the weapon probably didn’t malfunction.

“Pulling the trigger, however that trigger was pulled, was the only way for that gun to discharge,” Smith said. “This gun could not just be sitting on a table and all of a sudden, due to some malfunction, go off.”

Lopez-Sanchez’ attorney Matt Gonzalez suggested that his client “mishandled” the gun, which needs about five pounds of pressure to pull the trigger and successfully fire.

The preliminary hearing is expected to wrap up Wednesday and a judge will decide if Lopez-Sanchez should face trial.

Lopez-Sanchez was brought into court for a second day under heavy security. He was shackled at the waist and ankles. He spent much of the morning yawning, rubbing his eyes and dozing as Smith held up and discussed the gun used to kill Steinle.

On Tuesday, homicide detective Nico Discenza recounted his interview of Steinle’s father, Jim Steinle.

Jim Steinle told Discenza that he had his arm around his daughter as they strolled along San Francisco’s popular Pier 14.

Suddenly, he heard a loud “pop” and Kate Steinle slumped to the ground, moaning “Dad, help me, help me,” he testified Tuesday.

“He thought her cellphone blew up,” Discenza said.

Jim Steinle has since traveled to Washington, D.C., to testify before the Senate Judiciary Committee and to urge lawmakers to abolish local policies of ignoring federal immigration requests for cooperation with deportations.

San Francisco and other cities and counties ignore requests from federal authorities to detain jail inmates who are thought to be in the country illegally.

San Francisco Sheriff Ross Mirkarimi said he was following city law when jailers released Lopez-Sanchez after a 20-year-old marijuana possession charge was dropped. But leading politicians, including top Democrats such as California Sen. Dianne Feinstein and presidential hopeful Hillary Clinton, said Lopez-Sanchez should have been detained.