To help pay for a slew of proposals intended to give a leg up to the middle class, President Obama wants to close what he terms the "trust fund loophole."

What he's really referring to is the 'step-up in basis' on assets you leave to your heirs.

Here's how it works currently:

Say you bought bought a bunch of AT&T shares years ago for $100. At the time of your death, it's worth $500. That's a gain of $400 you haven't paid tax on.

In your will, you leave the shares to your daughter, whose cost basis "steps up" to $500. That means whenever she sells the stock, she would only owe tax on capital gains that accrue above her $500 cost basis. But the $400 gains that accrued during your lifetime are never taxed.

Obama is proposing that some estates should actually pay the capital gains tax on that $400. (And he would raise the capital gains rate.)

The White House estimates the proposal will primarily affect people with incomes over $2 million.

Related: Obama's proposal for the middle class

That's because the proposal includes a number of allowances so that the tax won't hit the college kid who inherits $10,000 in stock from Grandma, or indeed most Americans.

Everyone would get to exempt some capital gains: If you're single, you can bequeath investment assets with capital gains up to $100,000 tax free.

So say you bought a stock at $100,000 and it's worth $200,000 when you die. Your estate would not owe any capital gains tax.

If the stock was worth $300,000 when you die, you've got a $200,000 profit. The first $100,000 is exempt, and your estate would owe tax on the remaining $100,000.

Married couples are allowed to exempt $200,000. And any capital gains tax that is owed if the couple's gain exceed that exemption would not need to be paid until the last spouse dies.

And just as under current law, spouses may leave any and all assets to the surviving partner without tax consequence.

Homes provide an additional exemption: Capital gains on homes you bequeath would be tax-free up to $250,000 if you're single and $500,000 if you're married.

So if you bought a house at $300,000 and it's valued at $400,000 at your death, whether you were married or not, your estate would not owe any capital gains tax on that $100,000 gain.

Related: Obama bank tax: Smart policy or bank bashing?

The cost basis for the person who inherits it will be $400,000. And when the house is sold, your heir might be able to take another capital gains exemption of $250,000 ($500,000 if married) assuming the home served as that person's primary residence.

Gifts to charities would be exempt: If you leave appreciated assets to your favorite do-good nonprofit, your estate will not owe capital gains tax on any of it.

Most heirlooms would be tax-exempt: Excluding that Picasso, antique car collection or other major collectible worth millions, Obama's proposal would not apply to most of what's called "tangible personal property" -- e.g., your grandmother's ring or her beautiful dresser.

Small family businesses would only be taxed if sold: Say a parent dies and leaves the family-owned business to her kids.

If the kids continue to run the business, they would not owe any capital gains tax on the business unless they sold it. And if they did sell, the tax would be based on the gains that have accrued since the business was started.

But if they're set up as a closely held business, they would have 15 years to pay that tax after the sale.