The House failed to pass a 20-day stopgap bill to fund the Department of Homeland Security Friday, hurtling the agency toward a midnight shutdown deadline with no clear resolution in sight.

Most Democrats and 51 Republicans voted against the measure in a nail-biter decision that stretched on for more than 40 minutes.

The outcome leaves DHS just hours away from a partial shutdown in which non-essential employees would begin face furloughs. The outcome is a major defeat for House Speaker John A. Boehner (R-Ohio), who has struggled to govern even as Republicans hold unified control of Congress.

Related: Homeland Security Chief Worried about a Shabaab Mall Threat

The House GOP plan, which failed on a 203-224 vote, was meant as fallback proposal that Boehner put forth because the House and Senate have been unable to reach an agreement on a more lasting funding bill.

Speaking on the House floor after the vote, House Majority Leader Kevin McCarthy (R-Calif.) told members they should stand by for possible additional votes later Friday or during the weekend.

Before the vote, Rep. Raúl Grijalva (D-Ariz.), who represents a long stretch of the nation’s border with Mexico, said he was concerned that a Homeland Security shutdown would be devastating to the flow of goods -- particularly perishable fruits and vegetables -- across the border.

But he said he didn’t plan to vote for the three-week extension, noting that the delay would not change the political fundamentals of the impasse.

“The bullet must get bit by Boehner,” he said. “It either gets bit tonight ... or it gets bit in three weeks.”

Related: Factbox—What Happens If Homeland Security Funding Lapses?

The Senate passed its own bill Friday morning that would fund DHS through September and would not touch Obama’s immigration directives. The House passed a bill weeks ago that would fund DHS for the same period and would undo Obama’s directives.

Resistance in both chambers to the other one’s bill left lawmakers scrambling for an interim solution. The stopgap bill would have funded DHS through March 19.

The House passed a measure earlier Friday afternoon to go to conference with the Senate to hash out the differences between their long-term bills. No Democrats voted for it. Senate Democrats oppose a conference.

White House press secretary Josh Earnest told reporters Obama would sign a short-term bill, even though he would prefer a lengthier one.

“If president is faced with a choice of having the Department of Homeland Security shut down or fund that department for a short term, the president is not going to allow the agency to shut down,” said Earnest.

Related: Boehner Ready to Let Funding Lapse for Homeland Security

The speaker summoned his top lieutenants to a meeting in his office Friday afternoon as Republicans planned to move ahead on the stopgap bill, but there were signs that securing enough Republican votes remained a concern.

Democratic resistance complicated matters, though House Minority Leader Nancy Pelosi (D-Calif.) conceded Friday morning that “Republicans probably” had the votes to pass the bill to keep the department open.

But she called the measure a “staggering failure of leadership that will prolong this manufactured crisis of theirs and endanger the security of the American people.”

Pelosi’s remarks came after House Democratic leaders huddled with rank-and-file members. Leaving the meeting, some expressed sharp opposition to the stopgap measure.

“This is a gimmick. This is a waste of time,” said Rep. Nita M. Lowey (N.Y.), the top Democrat on the Appropriations Committee. “We need a one-year bill and that’s it.”

Senate Democratic aides acknowledged that the bill would probably have passed their chamber if it had cleared the House.

Related: Arrest of ISIS Backers Shows Need for Homeland Security Funding

Majority Leader Mitch McConnell (R-Ky.) put forward the Senate bill that passed Friday morning after it became clear the long-term House bill would not advance in his chamber. McConnell’s strategy has been panned by some House conservatives bent on battling Obama on immigration.

As they left Thursday’s House GOP meeting, Republican members said their leadership presented its plan as a way to get to conference with the Senate on their competing bills.

McConnell also tried to move forward Friday morning to consideration of a standalone measure that would undo Obama’s 2014 immigration actions, including stemming the deportations of millions of undocumented immigrants, but was blocked by Democrats. That bill is an effort to assuage conservatives in both chambers.

“Remember: President Obama said more than 20 times he couldn’t take those kinds of actions. He even referred to overreach like that as ‘ignoring the law,’ ” McConnell said on the Senate floor.

Related: Will the House Follow Ted Cruz and Vote to Fund DHS?

Senate Democratic leaders say they want to see DHS fully funded before they clear the way for consideration on the immigration bill.

Democrats have pointed to dangers the United States is confronting as the DHS debate is unfolding. They have cited the threat of the Islamic State, the mass shooting at a French satirical newspaper and concerns about disaster preparedness as reasons why Congress should not delay passage of “clean” bill that funds DHS through September.

At least one member has said he would forgo pay during a DHS shutdown, in solidarity with nonessential employees facing the prospect of a furlough.

“As long as the employees of the Department of Homeland Security including Border Patrol, Coast Guard and TSA are working while not receiving paychecks, I will ask that my paycheck be withheld,” Rep. Brad Sherman (D-Calif.) said in a Thursday statement.

Rep. Tim Huelskamp (R-Kan.), a conservative critic of GOP leadership, said Thursday that Boehner is handling the DHS fight “as best as can be expected.” But in a sign of lingering House-Senate tension, Huelskamp lashed out at McConnell.

“Harry Reid’s still in charge. There are going to be millions of folks that helped change the Senate from Democrat to Republican [who] are going to be disappointed in Senator McConnell,” he said.

Paul Kane contributed to this story.