Congress is poised to approve a compromise bill that radically overhauls how the Department of Defense buys and develops weapons, despite a looming veto threat from the White House.

The Senate on Tuesday voted 73-26 to advance the 2016 National Defense Authorization Act (NDAA). The measure sets policies for all Pentagon programs and activities for the coming fiscal year.

Related: The Pentagon’s New Bomber Faces a Potentially Costly Delay

The $612 billion policy roadmap, unveiled last week after months of conference negotiations by House and Senate lawmakers, includes acquisition reforms put forward by Senate Armed Services Committee chair John McCain (R-AZ) that shift responsibility for purchasing programs away from the office of the secretary of defense and gives it to the military service chiefs and secretaries.

The new scheme scraps a roughly 30-year-old buying system that gave one acquisition official -- the undersecretary of defense for acquisition, technology and logistics -- authority over weapon efforts.

In a committee hearing last week, McCain castigated the civilian office for its role overseeing the navy’s Ford-class aircraft carrier program, which he labeled “one of the most spectacular acquisition debacles in recent memory.” The effort is estimated to be $6 billion over budget.

“While the navy and the contractors deserve much of the blame, the milestone decision authority for the Ford-class program rests with the office of the secretary of defense, specifically the undersecretary of defense for acquisition technology and logistics,” he said.

Civilian appointees would retain oversight of joint weapons programs (those involving more than one military branch) and would be given control of major efforts such as the highly-anticipated long-range strike bomber if cost overruns reach more than 15 percent.

Should such an overrun – known as a Nunn-McCurdy breach, named after the authors of the law – take place, the services would also have to pay penalties of 3 percent of the cost overrun to the Pentagon.

Related: How to Build a $400 Billion F-35 That Doesn’t Fly

The change in authority would apply to new programs starting in fiscal 2017.

McCain’s sweeping alterations largely beat out those championed by his House counterpart, Rep. Mac Thornberry (R-TX). His plans focused more on streamlining the Pentagon’s acquisition bureaucracy and eliminating red tape to get cutting-edge weapons onto the battlefield faster, but left the chiefs largely out of the decision-making process.

Aides from both committees agree the differences between the two plans weren’t all that great and that any improvements are welcome to revamp a system that by many accounts has become bloated and costly.

McCain’s approach is the right one, according to Loren Thompson, chief operating officer of the Lexington Institute and a consultant who works with several defense contractors.

Related: 14 Deadly Weapons Russia Has Sent To Syria

“Centralization of acquisition functions has not worked. Rather than bringing greater coherence to the defense department’s investment choices, it has spawned a vast bureaucracy that slows the development of needed weapons while second-guessing the judgment of those who will use them,” he wrote last month in Forbes.

In July, Defense Secretary Ash Carter sent a letter Congress to express “significant concerns” about the proposed power shift, warning the move could lead to “unwarranted optimism in program planning.”

But speaking at a Defense One summit on Tuesday, Frank Kendall, DOD’s acquisition chief, said the “most egregious” problems with the buying overhaul had been removed in conference.

Besides the change in authority, the policy blueprint contains provisions that make it easier for the Pentagon to buy commercial, off-the-shelf technology, bypassing the acquisitions regime all together.

The Senate will likely approve the NDAA on Wednesday. But President Obama has threatened to veto the legislation because it includes a $38 billion increase to the Pentagon’s war fund, which would allow the agency to skirt sequestrations caps.

The legislative maneuver has riled Democrats, who want to negotiate a broader budget deal with the GOP that would lift the spending caps for both defense and domestic programs.

The bill contains “made-up money,” Senate Minority Whip Dick Durbin (D-IL), who chairs the Senate Appropriations Defense subpanel, said on the Senate floor before the procedural vote.

McCain responded angrily, noting the measure is “an authorization bill. It has nothing to do with the appropriations process.”

The House passed the NDAA conference bill last week 269 to 151, not enough to overcome the president’s veto.