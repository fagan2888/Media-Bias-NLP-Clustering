Foreign students in science and technology fields would be able to stay and work in the U.S. for up to three years after they get their degrees under a program the Obama administration proposed expanding on Friday, saying the country needs to find a way to keep those students-turned-workers here.

The program would cover hundreds of thousands of students, according to the proposal released by the Department of Homeland Security.

But critics say it would provide companies with a significant source of cheap labor, making it easier to stiff American workers.

The Optional Practical Training, or OPT, program is open to all foreign students, but Friday’s proposal focuses on those who graduate with degrees in science, technology, engineering or math, the so-called STEM fields.

The proposal would expand the amount of time those students are allowed to stay and work from 29 months to 36 months total after graduation in what are the equivalent of paid internships, while imposing new requirements on the businesses that hire them — including coming up with mentoring plans to try to make sure the interns are still learning.

Homeland Security is rushing to try to get the proposal finalized by Feb. 13, which is the date set by a court for ending a current program.

“Attracting and retaining such students is in the short-term and long-term economic, cultural and security interests of the nation,” Homeland Security Secretary Jeh Johnson said in the 107-page proposal, which is to be published in the Federal Register next week.

Mr. Johnson said the U.S. is competing for foreign students, who pump billions of dollars into the U.S. economy every year. Canada, in particular, is making a bid to attract them, he said.

One way of competing is to promise students that they can stay and work after they graduate, he said, vowing that will “ensure that we do not continue to lose ground” to Canada.

David North, a fellow at the Center for Immigration Studies, said the program should be scrapped, not expanded, if the government is interested in helping workers already looking for jobs here in the U.S.

“You’re not only talking about replacement workers, you’re talking about cheap replacement workers,” Mr. North said.

Because those in the OPT program are still deemed students — even though they have graduated — businesses don’t have to pay payroll taxes on their wages, creating an incentive worth thousands of dollars a year to employ them over American citizens, green card holders or those with legal work visas.

Mr. North also said the way the program is structured makes it tough for participating companies and foreign students to be policed.

The fight over foreign workers has heated up in recent years as some companies have looked to them as a cheap source of labor. Technology workers testified to Congress earlier this year about being forced to train the foreign workers who replaced them at their jobs.

A bipartisan group of senators wrote a letter asking for an investigation into the practice, but the Obama administration declined.

The OPT program changes are part of the executive actions President Obama announced in November, when he said he was no longer going to wait for Congress to rewrite the immigration law, and would instead change it himself.

The biggest part of that change was his proposal to grant a deportation amnesty to millions of illegal immigrant parents, but that has been put on hold by the federal courts, who ruled he was overstepping his powers. However, many of the other parts of his plan are being carried out.