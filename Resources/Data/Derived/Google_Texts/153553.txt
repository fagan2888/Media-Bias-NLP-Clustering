The House is set to vote Wednesday on a long-awaited bipartisan farm and nutrition bill designed to reduce long-term spending by about $23 billion. It eliminates direct payments to farmers, cuts spending on food stamps and consolidates a myriad of duplicative or wasteful programs.

House and Senate Republican and Democratic negotiators reached agreement on the five-year agriculture legislation Monday evening, capping nearly two years of often frustrating efforts by the two chambers to find common ground on the nearly $1 trillion bill. By far, the differences between the two chambers over food stamp funding posed the greatest stumbling block to a final agreement, although concerns about milk prices and benefits for the beef, pork and poultry industry created last-minute problems for the negotiators.

Related: $1 Trillion Spending Bill Splits Winners and Losers

The negotiations were led by House Agriculture Committee Chairman Frank D. Lucas (R-OK) and Senate Agriculture Committee Chairwoman Debbie Stabenow (D-MI). Both lawmakers boasted that the hard-won bipartisan agreement would provide an effective economic safety-net for the nation’s farmers while achieving major savings and reforms. Despite reservations of some members, the House is expected to approve the 949-page conference agreement tomorrow, while the Senate is likely to take it up next week.

Here are the highlights of the five major provisions of the bill:

Farm Subsidies – The agreement cuts about $19 billion in farm programs over five years. One of the most significant changes is the elimination of so-called direct payments – roughly $5 billion a year in generous payments to farmers and land owners regardless of whether they grow crops or not. The program has flourished since the late 1990s, and has drawn sharp condemnation from the Obama administration and lawmakers on both sides of the aisle as a prime example of government waste.

Related: Senate Played a Shell Game with New Farm Bill

Congress is playing a shell game of sorts with these subsidies. Some of the savings from eliminating direct payments will be added to the massive crop insurance program, in which the federal government covers losses from poor yields or declines in revenue. Crop insurance is purchased by agricultural producers, including farmers, ranchers and others to protect themselves against the loss of their crops due to natural disasters or the loss of revenue due to declines in the prices of agricultural commodities.

Taxpayers helped subsidize $7.8 billion in overpayments of crop insurance last year, according to a report by Iowa State University professor Bruce Babcock, reported by The Hill. With last year's drought leading to much higher prices, farmers were reimbursed at drought prices for their lost crops: $14 billion instead of the $6.2 billion that would have been paid under more standard insurance, according to the report. The report found that federal crop insurance subsidies are so high that farmers buy more generous plans than they otherwise might. Taxpayers pick up the tab for 62 percent of crop insurance premiums on average.

The shift of funding from direct payments to crop insurance is “a classic bait and switch proposal to protect farm subsidies,” Vincent H. Smith, a professor of farm economics at Montana State University, told The New York Times.

Related: Food Stamps—Desperate Need or Double Dealing?

Food Stamps – The Senate and House finally bridged their vast differences in efforts to cut spending on the $75 billion a year program that assists 47.8 million people. The agreement cuts spending on food stamps or Supplemental Nutrition Assistance Program by $8 billion over 10 years, or about one-fifth of the $40 billion sought by House Republicans. Negotiators agreed to tighten a provision that lets states give residents as little as $1 a year in heating assistance to qualify them for an average of $1,080 in additional nutrition aid.

Republicans successfully sought to lift the “heat and eat” threshold to $20, while Democrats proposed $10. The higher level creates about $8.5 billion of savings, with about $500 million plowed into other food-stamp-related initiatives. The net effect will be to reduce SNAP payments by about $90 a month for about 850,000 households.

The government’s cost of providing food stamps has exploded over the past decade, and critics have complained about rampant fraud. But advocates for the poor blasted the new spending agreement, saying it is unfair to the nation’s poorest people.

The new farm bill will prevent lottery winners from continuing to receive assistance. It also cracks down on benefit trafficking, and closes a loophole used by some states to artificially inflate benefits for a small number of recipients.

Related: Congress Likely to Pass $1 Trillion Spending Bill Without Reading It

Dairy prices – The new agreement ensures that the federal government will avoid re-implementing a 1940s era subsidy program that could have caused the price of milk to double to $7 a gallon from the current national average of $3.50. Instead, it will create a new milk insurance subsidy program. Concerns about the potential impact of the new legislation on milk prices posed one of the final stumbling blocks to an agreement. The bill reportedly has the blessing of the National Milk Producers Federation--even though that group's proposed Dairy Market Stabilization Program, designed to limit production on the nation's dairy farms during periods of low prices, was scrapped earlier this month.

Duplicative Programs – The new farm bill ends about 100 Department of Agriculture programs that are no longer working. It also take aim at duplicative programs, and will shrink 23 existing conservation programs into 13.

Deficit Reduction -- The bill will reduce the deficit by about $23 billion, according to preliminary 10-year Congressional Budget Office scores. The bipartisan deal will cut $19 billion from farm subsidy programs, save $6 billion by increasing efficiency in conservation programs and save another $8 billion by reforming food stamps. The bill spends an additional $10 billion on risk management and job creation and training.

Top Reads from the Fiscal Times: