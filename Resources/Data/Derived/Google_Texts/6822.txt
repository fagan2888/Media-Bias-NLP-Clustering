After an initial misstep, CUNY now appears on the right track when it comes to protecting the rights — and safety — of visiting lecturer David Petraeus.

After hecklers hounded the decorated retired general and ex-CIA chief last week for the second time — and after some nudging by us — CUNY has now read them the, uh, riot act and made clear the school will safeguard his right to teach “without obstruction.”

That’s good news. But time will tell if school officials keeps their word: The rabble-rousers have threatened to keep harassing Petraeus until he quits.

As we’ve pointed out, CUNY’s response to Petraeus’ assault on his first day was tepid. We urged the school to apologize — and come down harder on the troublemakers.

Indeed, the protesters must have agreed that CUNY was soft: On Tuesday, they amassed again, this time outside Macaulay Honors College, where Petraeus was speaking. When several of them crossed police barricades, a melee broke out. Six people were arrested for disorderly conduct, rioting and resisting arrest.

Interim Chancellor William Kelly then issued another statement: “Foreclosing the right of a faculty member to teach and the opportunity of students to learn is . . . corrosive of the values at the heart of the academic enterprise.” He said CUNY is committed to ensuring that Petraeus can teach “without harassment or obstruction.”

That’s more like it. Former Chancellor Matthew Goldstein spent the past decade and a half raising academic standards for the school and restoring its one-time stellar reputation. But along with high academic standards go high standards of behavior.

Harassment of the kind visited upon Petraeus suggests a decline on that front.

If CUNY still cares about keeping up its image as a turned-around school, it will make sure Petraeus — and other staff and students — are free to speak, teach and walk everywhere on campus.