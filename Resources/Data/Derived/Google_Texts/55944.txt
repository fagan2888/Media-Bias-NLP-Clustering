The Central Intelligence Agency has selected a new top spy, tapping an undercover veteran who played a central role in developing personal relationships with Afghan leaders after the U.S.-led invasion in 2001.

He remains undercover and is known within the agency as “Spider,” a U.S. official said. His new role will be director of the National Clandestine Service, a position that effectively makes him responsible for all the CIA’s...