President Obama used his final budget proposal Tuesday to try and shore up his health care legacy before he leaves office, tweaking Obamacare’s contentious “Cadillac” tax and enticing holdout states to expand Medicaid even as he targets a devastating heroin epidemic that’s got the attention of both parties.

Republicans want to scrap Obamacare, though — not sweeten it — and say the White House’s budget is dead on arrival because it hikes taxes to expand the government’s role instead of achieving balance, leaving little room for consensus in a thorny election year.

An end-of-year spending deal brokered by Mr. Obama and congressional leaders already delayed the “Cadillac” tax on generous employer health plans for two years, meaning it won’t take effect until 2020.

Yet Mr. Obama’s fiscal 2017 blueprint would adjust the 40-percent excise so that firms in areas with particularly expensive health care don’t face an outsized burden.

Right now, the Affordable Care Act applies the tax to the cost of coverage that exceeds $10,200 for an individual and $27,500 for a family.

Tuesday’s proposal would use the average premiums for “gold” tiered plans on each state’s Obamacare exchange as the threshold instead, but only if they exceed the current cutoff. The White House said this would be the fairest way to dissuade employers from offering overly generous coverage.

Yet outside groups such as the American Federation of Teachers, a labor union, and the Alliance to Fight the 40, an anti-Cadillac tax group, said anything short of repeal is unacceptable.

“The president’s proposal acknowledges that the tax is seriously flawed, but takes extremely modest steps to address the problem,” James A. Klein, president of the American Benefits Council, said through the alliance.

Another provision was aimed at states that have resisted a key pillar of Obamacare — the expansion of Medicaid to those making up to 138 percent of the federal poverty level.

Under existing law, the federal government pays the full tab for the expanded population, before scaling back its contribution to 90 percent in 2020 and beyond.

Mr. Obama’s proposal would allow 19 holdout states to enjoy the 100-percent match for three years, no matter when they expand. While it could grease the skids in states that are considering expansion, it probably won’t get far in Congress.

“I think the reality is that the provision included the president’s budget will never become law,” said Elizabeth Carpenter, a vice president at Avalere Health, a D.C.-based consultancy.

House Budget Committee Chairman Tom Price, Georgia Republican, has said his fiscal 2017 budget will, once again, envision the full repeal of Obamacare instead of tweaks that make it more palatable.

Republican Sens. John McCain of Arizona and David Perdue of Georgia filed a plan Tuesday to repeal and replace Obamacare with a plan that mirrors one by Mr. Price. It would use age-adjustment tax credits and health savings accounts, among other reforms, to shore up health coverage without onerous mandates.

But at least one aspect of Mr. Obama’s spending blueprint won rare, if guarded, kudos from Republican lawmakers.

The proposal sets aside $1 billion to fight the opioid painkiller and heroin epidemic that is ravaging the U.S. — a key priority for Senate Republicans locked in reelection battles in New Hampshire, Ohio and other states.

Kevin Smith, a spokesman for Sen. Rob Portman, Ohio Republican, said the senator wants more resources to fight the epidemic but that “he also supports, and has voted for, balanced budgets, so he understands the need to prioritize funding.”

“Obviously, the president did not do that here, but Congress will have to as it moves through the appropriations process,” he said.

Sen. Kelly Ayotte, New Hampshire Republican, applauded Mr. Obama’s focus on the problem, though she urged the administration to disburse funds that have already been appropriated by Congress, “so that communities have quick access to the resources they need to combat this epidemic.”