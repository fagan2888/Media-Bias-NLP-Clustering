For more than a year, Congress has been searching for a way to rein in the National Security Agency after Edward Snowden revealed a surveillance state larger than many imagined. Now, lawmakers might have finally accomplished their goal.

Senate Judiciary Committee Chairman Patrick Leahy introduced a revised version of his USA Freedom Act today, a bill that had passed the House in May. Leahy’s legislation makes a number of significant changes to the House bill, which was criticized by both tech companies and civil liberty groups. The bill would:

- Force the government to take steps to stop bulk data collection, eliminating a loophole in the House bill that civil liberty advocates said would allow a large amount of records to be still be collected.

Related: DOD's $5 Billion Push to Stop the Next Edward Snowden

- Increase government transparency requirements, forcing the intelligence community to give annual reports on the number of people or accounts on which data was collected.

- Demand the government report on the number of Americans subject to backdoor searches, or searches that involve digging for information on Americans in foreign countries.

- Set broader parameters for the kind of searches that tech companies can disclose. This should pacify those within the tech sector who wanted more transparency.

Related: Here's How Edward Snowden Got 'Top Secret' Clearance

According to Leahy’s office, the bill already has the backing of a broad range of tech and civil liberty groups.

“This is an historic opportunity, and I am grateful that the bill has the support of the administration, a wide range of privacy and civil liberties groups, and the technology industry," Leahy said in a statement released this morning. "We need to get this right, and we need to get it done without further delay.”

“If enacted, this bill would represent the most significant reform of government surveillance authorities since Congress passed the USA Patriot Act 13 years ago,” Leahy added.

This includes the Reform Government Surveillance Coalition, a group that includes tech giants like AOL, Facebook and Google. These companies have called for more transparency from the government on what kind of data is collected and how it is used.

Related: How Edward Snowden Changed the Habits of a Terrorist

It remains to be seen if the White House will back the bill. When the House passed its version of the bill, tech companies blasted the Obama administration for watering it down.

“We cannot in good conscience support this weakened version of the bill, where key reforms—especially those intended to end bulk collection and increase transparency—have been substantially watered down,” Kevin Bankston, Policy Director of the New America Foundation’s Open Technology Institute, said in May.

Leahy has been negotiating with the White House and the intelligence community regarding the changes in the Senate bill. If the White House signs the legislation, it would be a major step toward rolling back the surveillance state created after the 9/11 attacks.

It would also mean that Edward Snowden has finally won.

Top Reads from The Fiscal Times