The IRS is defending its decision to let illegal immigrants claim up to three years’ refunds on income even if they never paid income taxes, telling Congress in a new letter last week that agency lawyers have concluded getting a Social Security number triggers the ability to go back and ask for previous refunds.

President Obama’s new deportation amnesty could grant Social Security numbers to as many as 4 million illegal immigrants, making many of them eligible for tax refunds under the Earned Income Tax Credit even for years when they cheated on their taxes, by working off the books and not filing tax returns.

“Section 32 of the Internal Revenue Code requires an SSN on the return, but a taxpayer claiming the EITC is not required to have an SSN before the close of the year for which the EITC is claimed,” IRS Commissioner John Koskinen wrote in his letter to Sen. Charles E. Grassley on Wednesday.

PHOTOS: U.S. Open 2015: PGA Tour WAGs

The IRS’s chief lawyer had reached that conclusion in 2000, and the agency has newly confirmed it, Mr. Koskinen said.

Mr. Grassley called that a mockery of the law and said he will try to write a bill specifically prohibiting it.

“The tax code shouldn’t reward those who broke our immigration laws,” the Iowa Republican and chairman of the Senate Judiciary Committee said in a statement.

PHOTOS: Top earning dead celebrities

The tax issue has become one of several flash points over Mr. Obama’s deportation amnesty, which grants tentative legal status, Social Security numbers and work permits to illegal immigrants who qualify. The newly legalized workers would also likely be eligible for driver’s licenses, and could even be more attractive than native-born workers to some employers trying to figure out ways to save money under Obamacare mandates.

Mr. Koskinen has previously said that illegal immigrants must be able to prove they worked off-the-books in order to claim the EITC, and it’s unclear how many of the population Mr. Obama is aiming to cover would be able to offer such proof.

The three-year time frame is part of general tax law, allowing anyone who didn’t file to go back and claim a refund for up to three previous year’s worth of taxes.

But the IRS lawyer’s ruling creates an odd circumstance where illegal immigrants who cheated by not paying taxes before can see if they would benefit from refunds. If they do benefit, they could file, but if they don’t benefit they could continue to avoid taxes for those years.

Mr. Obama’s new amnesty program does not require payment of back taxes.

Congress is currently snared in a fight over Mr. Obama’s deportation amnesty, with House Republicans insisting it be ended and trying to tie continued funding for the Homeland Security Department to provisions that would halt the amnesty.

Democrats are universally opposed, and Senate Republicans, caught in the middle, have begun to side with Democrats, arguing that homeland security money must keep flowing no matter what.

A federal court has put Mr. Obama’s expanded amnesty on hold, finding that the president likely skirted federal law in issuing the new policy without first going through a period of public comment and review.